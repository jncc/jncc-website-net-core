function valShowerror(){return{restrict:"A",link:function(scope,element,attrs){scope.$watch(function(){return scope.$eval(attrs.valShowerror)},function(newVal){newVal===!0?element.addClass("highlight-error"):element.removeClass("highlight-error")})}}}angular.module("umbraco").controller("seoChecker.configurationissuesController",function($scope,$timeout,$routeParams,notificationsService,editorService,seocheckerBackofficeResources,seocheckerHelper){$scope.loaded=!1;$scope.initializeData=function(){seocheckerBackofficeResources.initializeConfigurationIssues().then(function(res){$scope.loaded=!0;$scope.model=res.data;seocheckerHelper.syncPath($scope.model.path)})};$scope.bindData=function(){seocheckerBackofficeResources.configurationIssues($scope.model).then(function(res){$scope.loaded=!0;$scope.model=res.data;seocheckerHelper.syncPath($scope.model.path)})};$scope.clearDialog=function(){var options={localizationKey:"seoCheckerBulkActions_bulkActionClearAllConfirmMessage",view:"/app_plugins/seochecker/dialogs/confirm.html",size:"small",submit:function(){seocheckerBackofficeResources.clearConfigurationIssues().then(function(res){seocheckerHelper.showNotification(res.data);$scope.bindData()});editorService.close()},close:function(){editorService.close()}};editorService.open(options)};$scope.filter=function(){$scope.bindData()};$scope.sort=function(column){$scope.model.setSortColumn=column;$scope.bindData()};$scope.setRecordCount=function(){$scope.model.resetPaging=!0;$scope.bindData()};$scope.goToPage=function(pageNumber){$scope.model.paging.currentPage=pageNumber;$scope.bindData()};$scope.showResult=function(){return $scope.model.hasRecords||$scope.model.filter!=null&&$scope.model.filter.length>0};$scope.handleSelectAll=function(){seocheckerHelper.handleSelectAll($scope.model.selectAll,$scope.model.data)};$scope.anyItemSelected=function(){return seocheckerHelper.anyItemSelected($scope.model.data)};$scope.isSortDirection=function(columnName,sortDirection){return seocheckerHelper.isSortDirection(columnName,sortDirection,$scope.model.orderByProperty,$scope.model.orderByDirection)};$scope.deleteSelected=function(){var options={selectedItems:seocheckerHelper.getSelectedItems($scope.model.data),view:"/app_plugins/seochecker/dialogs/validation/deleteconfigurationissues.html",size:"small",submit:function(){$scope.model.resetPaging=!0;$scope.bindData();editorService.close()},close:function(){editorService.close()}};editorService.open(options)};$scope.initializeData()});angular.module("umbraco").controller("seoChecker.definitionSettingsController",function($scope,$routeParams,notificationsService,editorService,eventsService,seocheckerBackofficeResources,seocheckerHelper){function tabChanged(tabinfo){var newActiveTab=seocheckerHelper.getTabByName($scope.model.tabs,tabinfo.alias);$scope.changeTab(newActiveTab)}var evts=[];$scope.bindData=function(){seocheckerBackofficeResources.initializeDefinitionSettings($routeParams.id).then(function(res){$scope.model=res.data;$scope.loaded=!0;seocheckerHelper.syncPath($scope.model.path);evts.push(eventsService.on("app.tabChange",function(name,tabAlias){tabChanged(tabAlias)}))},function(){seocheckerHelper.showServerError()})};$scope.getActiveTab=function(){if($scope.loaded===!0){var newActiveTab=$scope.model.tabs[0];return angular.isUndefined($scope.model)||angular.isUndefined($scope.model.tabs)?{}:($scope.model.tabs.forEach(function(tab){tab.active===!0&&(newActiveTab=tab)}),newActiveTab)}};$scope.changeTab=function(tab){$scope.model.tabs.forEach(function(tab){tab.active=!1});tab.active=!0};$scope.save=function(){seocheckerBackofficeResources.saveDefinitionSettings($scope.model).then(function(res){var model=res.data;seocheckerHelper.applyValidationErrors(model,$scope.model);model.isInValid||($scope.frm.$setPristine(),seocheckerHelper.showNotification(model.notificationStatus))},function(){seocheckerHelper.showServerError()})};$scope.bindData();$scope.$on("$destroy",function(){for(var e in evts)eventsService.unsubscribe(evts[e])})});angular.module("umbraco").controller("seoChecker.deleteController",function($scope,seocheckerBackofficeResources,treeService,navigationService){$scope.performDelete=function(){$scope.currentNode.loading=!0;treeService.removeNode($scope.currentNode);seocheckerBackofficeResources.deleteTreeNodeById($scope.currentNode.id).then(function(){$scope.currentNode.loading=!1;navigationService.hideMenu()})};$scope.cancel=function(){navigationService.hideDialog()}});angular.module("umbraco").controller("seoChecker.domainSettingsController",function($scope,$routeParams,notificationsService,editorService,eventsService,seocheckerBackofficeResources,seocheckerHelper){function tabChanged(tabinfo){var newActiveTab=seocheckerHelper.getTabByName($scope.model.tabs,tabinfo.alias);$scope.changeTab(newActiveTab)}var evts=[];$scope.bindData=function(){seocheckerBackofficeResources.initializeDomainSettings($routeParams.id).then(function(res){$scope.model=res.data;$scope.loaded=!0;seocheckerHelper.syncPath($scope.model.path);evts.push(eventsService.on("app.tabChange",function(name,tabAlias){tabChanged(tabAlias)}))},function(){seocheckerHelper.showServerError()})};$scope.getActiveTab=function(){if($scope.loaded===!0){var newActiveTab=$scope.model.tabs[0];return angular.isUndefined($scope.model)||angular.isUndefined($scope.model.tabs)?{}:($scope.model.tabs.forEach(function(tab){tab.active===!0&&(newActiveTab=tab)}),newActiveTab)}};$scope.save=function(){seocheckerBackofficeResources.saveDomainSettings($scope.model).then(function(res){var model=res.data;model.isInValid||($scope.frm.$setPristine(),seocheckerHelper.showNotification(model.notificationStatus))},function(){seocheckerHelper.showServerError()})};$scope.changeTab=function(tab){$scope.model.tabs.forEach(function(tab){tab.active=!1});tab.active=!0};$scope.bindData();$scope.$on("$destroy",function(){for(var e in evts)eventsService.unsubscribe(evts[e])})});angular.module("umbraco").controller("seoChecker.emailSettingsController",function($scope,$routeParams,notificationsService,editorService,seocheckerBackofficeResources,seocheckerHelper){$scope.bindData=function(){seocheckerBackofficeResources.initializeEmailSettings($routeParams.id).then(function(res){$scope.model=res.data;$scope.loaded=!0;seocheckerHelper.syncPath($scope.model.path)},function(){seocheckerHelper.showServerError()})};$scope.save=function(){seocheckerBackofficeResources.saveEmailSettings($scope.model).then(function(res){$scope.model=res.data;$scope.model.isInValid||(seocheckerHelper.showNotification($scope.model.notificationStatus),$scope.frm.$setPristine())},function(){seocheckerHelper.showServerError()})};$scope.bindData()});angular.module("umbraco").controller("seoChecker.generalSettingsController",function($scope,$rootScope,$routeParams,notificationsService,editorService,eventsService,seocheckerBackofficeResources,seocheckerHelper){function tabChanged(tabinfo){var newActiveTab=seocheckerHelper.getTabByName($scope.model.tabs,tabinfo.alias);$scope.changeTab(newActiveTab)}var evts=[];$scope.initialize=function(){seocheckerBackofficeResources.initializeGeneralSettingsModel().then(function(res){$scope.bindModelData(res.data)},function(){seocheckerHelper.showServerError()})};$scope.bindData=function(){seocheckerBackofficeResources.initializeGeneralSettings($scope.model).then(function(res){$scope.bindModelData(res.data)},function(){seocheckerHelper.showServerError()})};$rootScope.$on("seobooleanCheckbox.changed",function(event,data){data.alias==="enableUrlRewriting"&&$scope.updateTabModel("rewriteTab");data.alias==="enableRedirectmodule"&&$scope.updateTabModel("redirectTab");data.alias==="useFaceBook"&&$scope.updateTabModel("socialTab");data.alias==="useTwitter"&&$scope.updateTabModel("socialTab");data.alias==="robotsTxtEnabled"&&$scope.updateTabModel("robotsTxt");data.alias==="xmlSitemapEnabled"&&$scope.updateTabModel("xmlSitemapTab")});$scope.bindModelData=function(model){$scope.model=model;$scope.loaded=!0;seocheckerHelper.syncPath($scope.model.path);seocheckerHelper.syncPath($scope.model.path);evts.push(eventsService.on("app.tabChange",function(name,tabAlias){tabChanged(tabAlias)}))};$scope.getActiveTab=function(){if($scope.loaded===!0){var newActiveTab=$scope.model.tabs[0];return angular.isUndefined($scope.model)||angular.isUndefined($scope.model.tabs)?{}:($scope.model.tabs.forEach(function(tab){tab.active===!0&&(newActiveTab=tab)}),newActiveTab)}};$scope.changeTab=function(tab){$scope.model.tabs.forEach(function(tab){tab.active=!1});tab.active=!0};$scope.updateTabModel=function(tabName){seocheckerBackofficeResources.initializeGeneralSettings($scope.model).then(function(res){seocheckerHelper.updateTab($scope.model,res.data,tabName)},function(){seocheckerHelper.showServerError()})};$scope.save=function(){seocheckerBackofficeResources.saveGeneralSettings($scope.model).then(function(res){var model=res.data;model.isInValid||($scope.frm.$setPristine(),seocheckerHelper.showNotification(model.notificationStatus))},function(){seocheckerHelper.showServerError()})};$scope.initialize();$scope.$on("$destroy",function(){for(var e in evts)eventsService.unsubscribe(evts[e])})});angular.module("umbraco").controller("seoChecker.ignoredConfigurationController",function($scope,$timeout,$routeParams,notificationsService,localizationService,editorService,seocheckerBackofficeResources,seocheckerHelper){$scope.loaded=!1;$scope.initialize=function(){seocheckerBackofficeResources.initializeignoredConfigurationIssues().then(function(res){$scope.loaded=!0;$scope.model=res.data;seocheckerHelper.syncPath($scope.model.path)})};$scope.bindData=function(){seocheckerBackofficeResources.ignoredConfigurationIssues($scope.model).then(function(res){$scope.loaded=!0;$scope.model=res.data;seocheckerHelper.syncPath($scope.model.path)})};$scope.filter=function(){$scope.bindData()};$scope.sort=function(column){$scope.model.setSortColumn=column;$scope.bindData()};$scope.setRecordCount=function(){$scope.model.resetPaging=!0;$scope.bindData()};$scope.goToPage=function(pageNumber){$scope.model.paging.currentPage=pageNumber;$scope.bindData()};$scope.showResult=function(){return $scope.model.hasRecords||$scope.model.filter!=null&&$scope.model.filter.length>0};$scope.handleSelectAll=function(){seocheckerHelper.handleSelectAll($scope.model.selectAll,$scope.model.data)};$scope.anyItemSelected=function(){return seocheckerHelper.anyItemSelected($scope.model.data)};$scope.isSortDirection=function(columnName,sortDirection){return seocheckerHelper.isSortDirection(columnName,sortDirection,$scope.model.orderByProperty,$scope.model.orderByDirection)};$scope.deleteSelected=function(){var options={localizationKey:"seoCheckerBulkActions_bulkActionDeleteConfirmMessage",view:"/app_plugins/seochecker/dialogs/confirm.html",size:"small",submit:function(){var data=seocheckerHelper.getSelectedItems($scope.model.data);seocheckerBackofficeResources.removeIgnoredConfigurationIssues(data).then(function(res){seocheckerHelper.showNotification(res.data);$scope.bindData()});editorService.close()},close:function(){editorService.close()}};editorService.open(options)};$scope.initialize()});angular.module("umbraco").controller("seoChecker.ignoredInboundlinkissuesController",function($scope,$timeout,$routeParams,notificationsService,editorService,seocheckerBackofficeResources,seocheckerHelper){$scope.loaded=!1;$scope.initialize=function(){seocheckerBackofficeResources.initializeIgnoredInBoundLinkErrors().then(function(res){$scope.loaded=!0;$scope.model=res.data;seocheckerHelper.syncPath($scope.model.path)})};$scope.bindData=function(){seocheckerBackofficeResources.loadAllIgnoredInBoundLinkErrors($scope.model).then(function(res){$scope.loaded=!0;$scope.model=res.data;seocheckerHelper.syncPath($scope.model.path)})};$scope.filter=function(){$scope.bindData()};$scope.sort=function(column){$scope.model.setSortColumn=column;$scope.bindData()};$scope.setRecordCount=function(){$scope.model.resetPaging=!0;$scope.bindData()};$scope.goToPage=function(pageNumber){$scope.model.paging.currentPage=pageNumber;$scope.bindData()};$scope.showResult=function(){return $scope.model.hasRecords||$scope.model.filter!=null&&$scope.model.filter.length>0};$scope.handleSelectAll=function(){seocheckerHelper.handleSelectAll($scope.model.selectAll,$scope.model.data)};$scope.anyItemSelected=function(){return seocheckerHelper.anyItemSelected($scope.model.data)};$scope.isSortDirection=function(columnName,sortDirection){return seocheckerHelper.isSortDirection(columnName,sortDirection,$scope.model.orderByProperty,$scope.model.orderByDirection)};$scope.deleteSelected=function(){var options={localizationKey:"seoCheckerBulkActions_bulkActionDeleteConfirmMessage",view:"/app_plugins/seochecker/dialogs/confirm.html",size:"small",submit:function(){var data=seocheckerHelper.getSelectedItems($scope.model.data);seocheckerBackofficeResources.removeIgnoredInboundLinkIssues(data).then(function(res){seocheckerHelper.showNotification(res.data);$scope.bindData()});editorService.close()},close:function(){editorService.close()}};editorService.open(options)};$scope.initialize()});angular.module("umbraco").controller("seoChecker.ignoredValidationqueueController",function($scope,$timeout,$routeParams,notificationsService,localizationService,editorService,seocheckerBackofficeResources,seocheckerHelper){$scope.loaded=!1;$scope.initialize=function(){seocheckerBackofficeResources.initializeIgnoredValidationIssues().then(function(res){$scope.loaded=!0;$scope.model=res.data;seocheckerHelper.syncPath($scope.model.path)})};$scope.bindData=function(){seocheckerBackofficeResources.ignoredValidationIssues($scope.model).then(function(res){$scope.loaded=!0;$scope.model=res.data;seocheckerHelper.syncPath($scope.model.path)})};$scope.filter=function(){$scope.bindData()};$scope.sort=function(column){$scope.model.setSortColumn=column;$scope.bindData()};$scope.setRecordCount=function(){$scope.model.resetPaging=!0;$scope.bindData()};$scope.goToPage=function(pageNumber){$scope.model.paging.currentPage=pageNumber;$scope.bindData()};$scope.showResult=function(){return $scope.model.hasRecords||$scope.model.filter!=null&&$scope.model.filter.length>0};$scope.handleSelectAll=function(){seocheckerHelper.handleSelectAll($scope.model.selectAll,$scope.model.data)};$scope.anyItemSelected=function(){return seocheckerHelper.anyItemSelected($scope.model.data)};$scope.isSortDirection=function(columnName,sortDirection){return seocheckerHelper.isSortDirection(columnName,sortDirection,$scope.model.orderByProperty,$scope.model.orderByDirection)};$scope.deleteSelected=function(){var options={localizationKey:"seoCheckerBulkActions_bulkActionDeleteConfirmMessage",view:"/app_plugins/seochecker/dialogs/confirm.html",size:"small",submit:function(){var data=seocheckerHelper.getSelectedItems($scope.model.data);seocheckerBackofficeResources.removeIgnoredValidationIssues(data).then(function(res){seocheckerHelper.showNotification(res.data);$scope.bindData()});editorService.close()},close:function(){editorService.close()}};editorService.open(options)};$scope.initialize()});angular.module("umbraco").controller("seoChecker.inboundlinkissuesController",function($scope,$timeout,$routeParams,notificationsService,editorService,seocheckerBackofficeResources,seocheckerHelper){$scope.loaded=!1;$scope.initialize=function(){seocheckerBackofficeResources.initializeInBoundLinkErrors().then(function(res){$scope.loaded=!0;$scope.model=res.data;seocheckerHelper.syncPath($scope.model.path)})};$scope.bindData=function(){seocheckerBackofficeResources.loadAllInBoundLinkErrors($scope.model).then(function(res){$scope.loaded=!0;$scope.model=res.data;seocheckerHelper.syncPath($scope.model.path)})};$scope.save=function(){seocheckerBackofficeResources.saveInBoundLinkErrors($scope.model.data).then(function(res){$scope.model=res.data;seocheckerHelper.showNotification($scope.model.notificationStatus)})};$scope.filter=function(){$scope.bindData()};$scope.sort=function(column){$scope.model.setSortColumn=column;$scope.bindData()};$scope.setRecordCount=function(){$scope.model.resetPaging=!0;$scope.bindData()};$scope.goToPage=function(pageNumber){$scope.model.paging.currentPage=pageNumber;$scope.bindData()};$scope.showResult=function(){return $scope.model.hasRecords||$scope.model.filter!=null&&$scope.model.filter.length>0};$scope.handleSelectAll=function(){seocheckerHelper.handleSelectAll($scope.model.selectAll,$scope.model.data)};$scope.anyItemSelected=function(){return seocheckerHelper.anyItemSelected($scope.model.data)};$scope.isSortDirection=function(columnName,sortDirection){return seocheckerHelper.isSortDirection(columnName,sortDirection,$scope.model.orderByProperty,$scope.model.orderByDirection)};$scope.deleteSelected=function(){var options={selectedItems:seocheckerHelper.getSelectedItems($scope.model.data),view:"/app_plugins/seochecker/dialogs/redirects/deleteredirects.html",size:"small",submit:function(){$scope.model.resetPaging=!0;$scope.bindData();editorService.close()},close:function(){editorService.close()}};editorService.open(options)};$scope.editRedirect=function(id){var options={redirectid:id,view:"/app_plugins/seochecker/dialogs/redirects/editredirects.html",size:"small",submit:function(){$scope.model.resetPaging=!0;$scope.bindData();editorService.close()},close:function(){editorService.close()}};editorService.open(options)};$scope.showDialog=function(item){var dialogOptions={multiPicker:!1,startNodeId:null,submit:function(data){item.id=data.selection[0].id;item.name=data.selection[0].name;$scope.$$phase||$scope.$apply();editorService.close()},close:function(){editorService.close()},idType:"int"};item.contentType==="media"?editorService.mediaPicker(dialogOptions):editorService.contentPicker(dialogOptions)};$scope.clear=function(item){item.id=null;item.name=""};$scope.buttonGroup={defaultButton:{labelKey:"buttons_save",hotKey:"ctrl+s",hotKeyWhenHidden:!1,handler:function(){$scope.save()}},subButtons:[{labelKey:"seoCheckerBulkActions_bulkActionClearAllButton",hotKey:"ctrl+d",hotKeyWhenHidden:!1,handler:function(){var options={localizationKey:"seoCheckerBulkActions_bulkActionClearAllConfirmMessage",view:"/app_plugins/seochecker/dialogs/confirm.html",size:"small",submit:function(){seocheckerBackofficeResources.clearInboundLinkIssues().then(function(res){seocheckerHelper.showNotification(res.data);$scope.bindData()});editorService.close()},close:function(){editorService.close()}};editorService.open(options)}}]};$scope.initialize()});angular.module("umbraco").controller("seoChecker.notificationsController",function($scope,$routeParams,notificationsService,editorService,seocheckerBackofficeResources,seocheckerHelper){$scope.bindData=function(){seocheckerBackofficeResources.initializeNotifications().then(function(res){$scope.model=res.data;$scope.loaded=!0;seocheckerHelper.syncPath($scope.model.path)},function(){seocheckerHelper.showServerError()})};$scope.save=function(){seocheckerBackofficeResources.saveNotifications($scope.model).then(function(res){$scope.model=res.data;res.data.isInValid||($scope.frm.$setPristine(),seocheckerHelper.showNotification($scope.model.notificationStatus))},function(){seocheckerHelper.showServerError()})};$scope.bindData()});angular.module("umbraco").controller("seoChecker.permissionSettingsController",function($scope,$routeParams,notificationsService,editorService,seocheckerBackofficeResources,seocheckerHelper){$scope.bindData=function(){seocheckerBackofficeResources.initializePermissionSettings().then(function(res){$scope.model=res.data;$scope.loaded=!0;seocheckerHelper.syncPath($scope.model.path)},function(){seocheckerHelper.showServerError()})};$scope.save=function(){seocheckerBackofficeResources.savePermissionSettings($scope.model).then(function(res){var model=res.data;model.isInValid||($scope.frm.$setPristine(),seocheckerHelper.showNotification(model.notificationStatus))},function(){seocheckerHelper.showServerError()})};$scope.bindData()});angular.module("umbraco").controller("seoChecker.redirectmanagerController",function($scope,$timeout,$routeParams,notificationsService,editorService,seocheckerBackofficeResources,seocheckerHelper){$scope.loaded=!1;$scope.initialize=function(){seocheckerBackofficeResources.initializeRedirects().then(function(res){$scope.setData(res.data)})};$scope.bindData=function(){seocheckerBackofficeResources.loadAllRedirects($scope.model).then(function(res){$scope.setData(res.data)})};$scope.setData=function(model){$scope.loaded=!0;$scope.model=model;seocheckerHelper.syncPath($scope.model.path)};$scope.doExport=function(model){var url=seocheckerBackofficeResources.getRedirectExportUrl(model);seocheckerHelper.downloadFile(url)};$scope.doImport=function(model){seocheckerBackofficeResources.importRedirects(model).then(function(){})};$scope.filter=function(){$scope.bindData()};$scope.sort=function(column){$scope.model.setSortColumn=column;$scope.bindData()};$scope.setRecordCount=function(){$scope.model.resetPaging=!0;$scope.bindData()};$scope.goToPage=function(pageNumber){$scope.model.paging.currentPage=pageNumber;$scope.bindData()};$scope.showResult=function(){return $scope.model.hasRecords||$scope.model.filter!=null&&$scope.model.filter.length>0};$scope.handleSelectAll=function(){seocheckerHelper.handleSelectAll($scope.model.selectAll,$scope.model.data)};$scope.anyItemSelected=function(){return seocheckerHelper.anyItemSelected($scope.model.data)};$scope.isSortDirection=function(columnName,sortDirection){return seocheckerHelper.isSortDirection(columnName,sortDirection,$scope.model.orderByProperty,$scope.model.orderByDirection)};$scope.deleteSelected=function(){var options={selectedItems:seocheckerHelper.getSelectedItems($scope.model.data),view:"/app_plugins/seochecker/dialogs/redirects/deleteredirects.html",size:"small",submit:function(){$scope.model.resetPaging=!0;$scope.bindData();editorService.close()},close:function(){editorService.close()}};editorService.open(options)};$scope.editRedirect=function(id){var options={redirectid:id,view:"/app_plugins/seochecker/dialogs/redirects/editredirects.html",size:"small",submit:function(){$scope.model.resetPaging=!0;$scope.bindData();editorService.close()},close:function(){editorService.close()}};editorService.open(options)};$scope.buttonGroup={defaultButton:{labelKey:"seoCheckerRedirectManager_createButton",hotKey:"ctrl+n",hotKeyWhenHidden:!0,handler:function(){$scope.editRedirect("0")}},subButtons:[{labelKey:"seoCheckerExportRedirects_exportOptionButton",hotKey:"ctrl+e",hotKeyWhenHidden:!0,handler:function(){var options={view:"/app_plugins/seochecker/dialogs/redirects/exportredirects.html",size:"small",submit:function(model){model!=null&&$scope.doExport(model);editorService.close()},close:function(){editorService.close()}};editorService.open(options)}},{labelKey:"seoCheckerImportRedirects_importOptionButton",hotKey:"ctrl+i",hotKeyWhenHidden:!0,handler:function(){var options={view:"/app_plugins/seochecker/dialogs/redirects/importredirects.html",size:"small",submit:function(){$scope.model.resetPaging=!0;$scope.bindData();editorService.close()},close:function(){editorService.close()}};editorService.open(options)}}]};$scope.initialize()});angular.module("umbraco").controller("seoChecker.validateController",function($scope,$routeParams,notificationsService,editorService,seocheckerBackofficeResources,seocheckerHelper){$scope.bindData=function(){seocheckerBackofficeResources.initializeValidationForm($routeParams.id).then(function(res){$scope.model=res.data;$scope.loaded=!0;seocheckerHelper.syncPath($scope.model.path);$scope.setTitle()})};$scope.selectRoot=function(){editorService.contentPicker({startNodeId:-1,multiPicker:!1,callback:function(data){$scope.model.rootNode.id=data.id;$scope.model.rootNode.name=data.name}})};$scope.validate=function(){seocheckerBackofficeResources.validate($scope.model).then(function(res){$scope.model=res.data;$scope.setTitle();seocheckerHelper.showNotification($scope.model.notificationStatus);$scope.frm.$setPristine()})};$scope.save=function(){seocheckerBackofficeResources.saveValidation($scope.model).then(function(res){$scope.model=res.data;$scope.setTitle();$scope.model.isInValid||(seocheckerHelper.syncPath($scope.model.path),seocheckerHelper.showNotification($scope.model.notificationStatus));$scope.frm.$setPristine()})};$scope.setTitle=function(){$scope.model.displayPageName=$scope.model.scheduledValidation?$scope.model.scheduleValidationPageName:$scope.model.pageName};$scope.buttonGroup={defaultButton:{labelKey:"seoCheckerValidate_validationStart",hotKey:"ctrl+s",buttonStyle:"primary",hotKeyWhenHidden:!0,handler:function(){$scope.validate()}},subButtons:[{labelKey:"seoCheckerValidate_scheduleButton",hotKey:"ctrl+e",hotKeyWhenHidden:!0,handler:function(){$scope.model.scheduledValidation=!0;$scope.setTitle()}}]};$scope.bindData()});angular.module("umbraco").controller("seoChecker.validationissuesController",function($scope,$timeout,$routeParams,notificationsService,editorService,seocheckerBackofficeResources,seocheckerHelper){$scope.loaded=!1;$scope.initializeData=function(){seocheckerBackofficeResources.initializevalidationIssues().then(function(res){$scope.loaded=!0;$scope.model=res.data;seocheckerHelper.syncPath($scope.model.path)})};$scope.bindData=function(){seocheckerBackofficeResources.validationIssues($scope.model).then(function(res){$scope.loaded=!0;$scope.model=res.data;seocheckerHelper.syncPath($scope.model.path)})};$scope.clearDialog=function(){var options={localizationKey:"seoCheckerBulkActions_bulkActionClearAllConfirmMessage",view:"/app_plugins/seochecker/dialogs/confirm.html",size:"small",submit:function(){seocheckerBackofficeResources.clearValidationIssues().then(function(res){seocheckerHelper.showNotification(res.data);$scope.bindData()});editorService.close()},close:function(){editorService.close()}};editorService.open(options)};$scope.filter=function(){$scope.bindData()};$scope.sort=function(column){$scope.model.setSortColumn=column;$scope.bindData()};$scope.setRecordCount=function(){$scope.model.resetPaging=!0;$scope.bindData()};$scope.goToPage=function(pageNumber){$scope.model.paging.currentPage=pageNumber;$scope.bindData()};$scope.showResult=function(){return $scope.model.hasRecords||$scope.model.filter!=null&&$scope.model.filter.length>0};$scope.handleSelectAll=function(){seocheckerHelper.handleSelectAll($scope.model.selectAll,$scope.model.data)};$scope.anyItemSelected=function(){return seocheckerHelper.anyItemSelected($scope.model.data)};$scope.isSortDirection=function(columnName,sortDirection){return seocheckerHelper.isSortDirection(columnName,sortDirection,$scope.model.orderByProperty,$scope.model.orderByDirection)};$scope.deleteSelected=function(){var options={selectedItems:seocheckerHelper.getSelectedItems($scope.model.data),view:"/app_plugins/seochecker/dialogs/validation/deletevalidationissues.html",size:"small",submit:function(){$scope.model.resetPaging=!0;$scope.bindData();editorService.close()},close:function(){editorService.close()}};editorService.open(options)};$scope.revalidateSelected=function(){var options={selectedItems:seocheckerHelper.getSelectedItems($scope.model.data),view:"/app_plugins/seochecker/dialogs/validation/revalidatevalidationissues.html",size:"small",submit:function(){$scope.model.resetPaging=!0;$scope.bindData();editorService.close()},close:function(){editorService.close()}};editorService.open(options)};$scope.openDocument=function(id){window.open("/umbraco/#/content/content/edit/"+id,"_blank","width = 900, height = 800")};$scope.openTemplate=function(id){window.open("/umbraco#/settings/templates/edit/"+id,"_blank","width = 900, height = 800")};$scope.initializeData()});angular.module("umbraco").controller("seoChecker.validationqueueController",function($scope,$timeout,$routeParams,notificationsService,editorService,seocheckerBackofficeResources,seocheckerHelper){$scope.loaded=!0;$scope.bindData=function(){seocheckerBackofficeResources.initializeValidationqueue().then(function(res){$scope.loaded=!0;$scope.model=res.data;seocheckerHelper.syncPath($scope.model.path)});$scope.timer=$timeout($scope.reloadData,1e4)};$scope.reloadData=function(){$scope.CancelTimer();seocheckerBackofficeResources.validationqueue($scope.model).then(function(res){$scope.loaded=!0;$scope.model=res.data;$scope.timer=$timeout($scope.reloadData,1e4)})};$scope.$on("$destroy",function(){$scope.CancelTimer()});$scope.CancelTimer=function(){$timeout.cancel($scope.timer)};$scope.clearDialog=function(){var options={localizationKey:"seoCheckerValidationQueue_confirmMessage",view:"/app_plugins/seochecker/dialogs/confirm.html",size:"small",submit:function(){seocheckerBackofficeResources.clearValidationqueue($scope.model).then(function(res){$scope.model=res.data;seocheckerHelper.showNotification($scope.model.notificationStatus)});editorService.close()},close:function(){editorService.close()}};editorService.open(options)};$scope.sort=function(column){$scope.model.setSortColumn=column;$scope.reloadData()};$scope.setRecordCount=function(){$scope.model.resetPaging=!0;$scope.reloadData()};$scope.goToPage=function(pageNumber){$scope.model.paging.currentPage=pageNumber;$scope.reloadData()};$scope.isSortDirection=function(columnName,sortDirection){return seocheckerHelper.isSortDirection(columnName,sortDirection,$scope.model.orderByProperty,$scope.model.orderByDirection)};$scope.bindData()});angular.module("umbraco").controller("seoChecker.dashboardController",function($scope,$timeout,$routeParams,notificationsService,editorService,seocheckerBackofficeResources,seocheckerHelper){$scope.bindData=function(){seocheckerBackofficeResources.initializeDashboard().then(function(res){$scope.loaded=!0;$scope.model=res.data})};$scope.upload=function(){var fileInput=document.getElementById("selectLicenseFile");seocheckerHelper.uploadFiles("uploadlicense",fileInput.files[0],function(result){var fileInfo=JSON.parse(seocheckerHelper.fixJqueryResult(result));seocheckerBackofficeResources.processLicenseFile(fileInfo).then(function(res){var uploadedModel=res.data;seocheckerHelper.showNotification(uploadedModel.notificationStatus);$scope.bindData()})})};$scope.bindData()});angular.module("umbraco").controller("seoChecker.ConfirmDialogController",function($scope,localizationService){$scope.initializeConfirm=function(){localizationService.localize($scope.model.localizationKey).then(function(value){$scope.confirmCaption=value})};$scope.confirm=function(){$scope.model&&$scope.model.close&&$scope.model.submit()};$scope.cancel=function(){$scope.model&&$scope.model.close&&$scope.model.close()};$scope.initializeConfirm()});angular.module("umbraco").controller("seoChecker.DeleteRedirectsController",function($scope,localizationService,seocheckerBackofficeResources,seocheckerHelper){$scope.initializeConfirm=function(){$scope.parentModel=$scope.model;seocheckerBackofficeResources.initializeDeleteRedirects($scope.parentModel.selectedItems).then(function(res){$scope.model=res.data;$scope.loaded=!0})};$scope.confirm=function(){seocheckerBackofficeResources.bulkDeleteRedirects($scope.model).then(function(res){$scope.model=res.data;seocheckerHelper.showNotification($scope.model.notificationStatus);$scope.parentModel&&$scope.parentModel.submit&&$scope.parentModel.submit()})};$scope.cancel=function(){$scope.parentModel&&$scope.parentModel.close&&$scope.parentModel.close()};$scope.initializeConfirm()});angular.module("umbraco").controller("seoChecker.EditRedirectsController",function($scope,localizationService,seocheckerBackofficeResources,seocheckerHelper){$scope.initializeConfirm=function(){$scope.parentModel=$scope.model;seocheckerBackofficeResources.initializeEditRedirect($scope.parentModel.redirectid).then(function(res){$scope.model=res.data;$scope.loaded=!0;$scope.$watch("model.tabs['0'].properties[0].value",function(newVal,oldVal){newVal!==oldVal&&(seocheckerHelper.isNullOrUndefined(newVal)||seocheckerBackofficeResources.getContentTypeOfRedirectUrl(newVal).then(function(res){$scope.model.tabs[0].properties[1].value.contentType=res.data}))},!0)})};$scope.save=function(){seocheckerBackofficeResources.saveRedirect($scope.model).then(function(res){var result=res.data;result.isInValid||(seocheckerHelper.showNotification(result.notificationStatus),$scope.parentModel&&$scope.parentModel.submit&&$scope.parentModel.submit())})};$scope.onCancel=function(){$scope.parentModel&&$scope.parentModel.close&&$scope.parentModel.close()};$scope.initializeConfirm()});angular.module("umbraco").controller("seoChecker.ExportRedirectsController",function($scope,localizationService,seocheckerBackofficeResources){$scope.initializeExport=function(){$scope.parentModel=$scope.model;seocheckerBackofficeResources.initializeExportRedirects($scope.dialogData).then(function(res){$scope.model=res.data;$scope.loaded=!0})};$scope.export=function(){seocheckerBackofficeResources.exportRedirects($scope.model).then(function(res){$scope.model=res.data;$scope.model.isInValid||$scope.parentModel.submit($scope.model)})};$scope.onCancel=function(){$scope.parentModel&&$scope.parentModel.close&&$scope.parentModel.close()};$scope.initializeExport()});angular.module("umbraco").controller("seoChecker.ImportRedirectsController",function($scope,localizationService,seocheckerBackofficeResources,seocheckerHelper,fileManager,$http,$rootScope){$scope.initializeImportRedirects=function(){$scope.parentModel=$scope.model;seocheckerBackofficeResources.initializeImportRedirects().then(function(res){$scope.model=res.data;$scope.loaded=!0})};$scope.updateModel=function(){seocheckerBackofficeResources.redirectUpdateModel($scope.model).then(function(res){$scope.model=res.data;$scope.loaded=!0})};$scope.import=function(){seocheckerBackofficeResources.importRedirects($scope.model).then(function(res){$scope.model=res.data;$scope.loaded=!0})};$scope.exportErrors=function(){var url=seocheckerBackofficeResources.getExportRedirectErrorsUrl($scope.model);seocheckerHelper.downloadFile(url)};$rootScope.$on("seodropdown.changed",function(event,data){data.alias==="worksheet"&&($scope.model.resetWorksheet=!0,$scope.updateModel());data.alias==="importProvider"&&seocheckerBackofficeResources.bindImportRedirects($scope.model).then(function(res){$scope.model=res.data;$scope.loaded=!0})});$scope.upload=function(){var fileInput=document.getElementById("uploadSeoFile");seocheckerHelper.uploadFiles("redirectimport",fileInput.files[0],function(res){var fileInfo=JSON.parse(seocheckerHelper.fixJqueryResult(res));$scope.model.importFileInfo=fileInfo;$scope.updateModel()})};$scope.showUploadButton=function(){return angular.isObject($scope.model)&&$scope.model.fileSelected===!1};$scope.showImportButton=function(){return angular.isObject($scope.model)&&$scope.model.fileSelected===!0&&$scope.model.fileImported===!1};$scope.showResult=function(){return angular.isObject($scope.model)&&$scope.model.fileImported===!0};$scope.hasImportErrors=function(){return angular.isObject($scope.model)&&$scope.model.importErrors>0};$scope.getTabByName=function(tabName){return angular.isUndefined($scope.model)||angular.isUndefined($scope.model.tabs)?{}:seocheckerHelper.getTabByName($scope.model.tabs,tabName)};$scope.onCancel=function(){$scope.parentModel&&$scope.parentModel.close&&$scope.parentModel.close()};$scope.close=function(){$scope.parentModel&&$scope.parentModel.close&&$scope.parentModel.submit()};$scope.initializeImportRedirects()});angular.module("umbraco").controller("seoChecker.DeleteConfigurationIssuesController",function($scope,localizationService,seocheckerBackofficeResources,seocheckerHelper){$scope.initializeConfirm=function(){$scope.parentModel=$scope.model;seocheckerBackofficeResources.initializeDeleteConfigurationIssues($scope.parentModel.selectedItems).then(function(res){$scope.model=res.data;$scope.loaded=!0})};$scope.confirm=function(){seocheckerBackofficeResources.bulkDeleteConfigurationIssues($scope.model).then(function(res){$scope.model=res.data;seocheckerHelper.showNotification($scope.model.notificationStatus);$scope.parentModel&&$scope.parentModel.submit&&$scope.parentModel.submit()})};$scope.cancel=function(){$scope.parentModel&&$scope.parentModel.close&&$scope.parentModel.close()};$scope.initializeConfirm()});angular.module("umbraco").controller("seoChecker.DeleteValidationIssuesController",function($scope,localizationService,seocheckerBackofficeResources,seocheckerHelper){$scope.initializeConfirm=function(){$scope.parentModel=$scope.model;seocheckerBackofficeResources.initializeDeleteValidationIssues($scope.parentModel.selectedItems).then(function(res){$scope.model=res.data;$scope.loaded=!0})};$scope.confirm=function(){seocheckerBackofficeResources.bulkDeleteValidationIssues($scope.model).then(function(res){$scope.model=res.data;seocheckerHelper.showNotification($scope.model.notificationStatus);$scope.parentModel&&$scope.parentModel.submit&&$scope.parentModel.submit()})};$scope.cancel=function(){$scope.parentModel&&$scope.parentModel.close&&$scope.parentModel.close()};$scope.initializeConfirm()});angular.module("umbraco").controller("seoChecker.RevalidateValidationIssuesController",function($scope,localizationService,seocheckerBackofficeResources,seocheckerHelper,$timeout){$scope.initialize=function(){$scope.parentModel=$scope.model;$scope.loaded=!1;seocheckerBackofficeResources.initializeRevalidateIssues($scope.parentModel.selectedItems).then(function(res){$scope.loaded=!0;$scope.model=res.data;$scope.timer=$timeout($scope.refreshStatus,1e3)})};$scope.refreshStatus=function(){$scope.timer=$timeout($scope.refreshStatus,1e3);seocheckerBackofficeResources.refreshRevalidateIssues($scope.model).then(function(res){$scope.model=res.data;$scope.model.finished===!0&&$scope.parentModel&&$scope.parentModel.submit&&$scope.parentModel.submit()})};$scope.onCancel=function(){$scope.parentModel&&$scope.parentModel.close&&$scope.parentModel.close()};$scope.$on("$destroy",function(){$scope.CancelTimer()});$scope.CancelTimer=function(){$timeout.cancel($scope.timer)};$scope.initialize()});angular.module("umbraco.directives").directive("seocheckerHeader",function(seocheckerResourceService){return{transclude:!0,restrict:"E",replace:!0,link:function(scope,element){seocheckerResourceService.localize("SEOChecker").then(function(value){element.html("<h1>"+value+"<\/h1>")})}}});angular.module("umbraco.directives").directive("seocheckerLicenseinfo",function(seocheckerBackofficeResources){return{transclude:!0,restrict:"E",replace:!0,link:function(scope,element){seocheckerBackofficeResources.getLicenseInfo().then(function(res){res.data.licenseError===!0&&element.html('<div class="alert alert-error seocheckerLicenseInfo">'+res.data.licenseMessage+"<\/div>");res.data.trialLicense===!0&&element.html('<div class="alert alert-warning seocheckerLicenseInfo">'+res.data.licenseMessage+"<\/div>")})}}});angular.module("umbraco.directives").directive("valShowerror",valShowerror);angular.module("umbraco").controller("seoChecker.autovalidationOptionsController",function($scope){$scope.model.value||($scope.model.value="always");$scope.LocalizePrevalue=function(preval){return preval==="always"?"Always validate automatically":preval==="aftersave"?"Automatically validate after save":"Never validate automatically"};$scope.model.prevalues=["never","always","aftersave"]});angular.module("umbraco").controller("seoChecker.booleanFieldController",function($scope,$rootScope){$scope.itemChanged=function(item){item.value=!item.value;$rootScope.$broadcast("seobooleanCheckbox.changed",{alias:item.alias,value:item.value})}});angular.module("umbraco").controller("seoChecker.dropdownSelectorController",function($scope,$rootScope){$scope.itemChanged=function(item){$rootScope.$broadcast("seodropdown.changed",{alias:item.alias,value:item.value.selectedItem})}});angular.module("umbraco").controller("seoChecker.imagePropertyDropdownController",function($scope,$routeParams,notificationsService,editorService,seocheckerBackofficeResources,seocheckerHelper){$scope.bindData=function(){seocheckerBackofficeResources.getAllImageProperties().then(function(res){$scope.model.items=res.data},function(){seocheckerHelper.showServerError()})};$scope.bindData()});angular.module("umbraco").controller("seoChecker.propertyDropdownController",function($scope,$routeParams,notificationsService,editorService,seocheckerBackofficeResources,seocheckerHelper){$scope.bindData=function(){seocheckerBackofficeResources.getAllProperties().then(function(res){$scope.model.items=res.data},function(){seocheckerHelper.showServerError()})};$scope.bindData()});angular.module("umbraco").controller("seoChecker.propertySelectorController",function($scope,$routeParams,notificationsService,editorService,seocheckerBackofficeResources){$scope.bindData=function(){seocheckerBackofficeResources.initializePropertySelectorField($routeParams.id).then(function(res){$scope.properties=res.data;$scope.properties.value=$scope.model.value;$scope.properties.filterType=$scope.model.config.propertyTypeFilter;$scope.initializeValue();$scope.loaded=!0})};$scope.initializeValue=function(){seocheckerBackofficeResources.initializePropertySelectorValue($scope.properties).then(function(res){$scope.properties=res.data;$scope.model.value=$scope.properties.value})};$scope.selectItems=function(){seocheckerBackofficeResources.selectPropertySelectorFields($scope.properties).then(function(res){$scope.properties=res.data;$scope.model.value=$scope.properties.value})};$scope.deSelectItems=function(){seocheckerBackofficeResources.deSelectPropertySelectorFields($scope.properties).then(function(res){$scope.properties=res.data;$scope.model.value=$scope.properties.value})};$scope.moveUp=function(){seocheckerBackofficeResources.moveUpPropertySelectorFields($scope.properties).then(function(res){$scope.properties=res.data;$scope.model.value=$scope.properties.value})};$scope.moveDown=function(){seocheckerBackofficeResources.moveDownPropertySelectorFields($scope.properties).then(function(res){$scope.properties=res.data;$scope.model.value=$scope.properties.value})};$scope.bindData()});angular.module("umbraco").controller("seoChecker.seocontentPickerController",function($scope,$routeParams,notificationsService,editorService){$scope.showDialog=function(){var dialogOptions={multiPicker:!1,startNodeId:null,submit:function(data){$scope.model.value.id=data.selection[0].id;$scope.model.value.name=data.selection[0].name;editorService.close()},close:function(){editorService.close()},idType:"int"};$scope.model.value.contentType==="media"?editorService.mediaPicker(dialogOptions):editorService.contentPicker(dialogOptions)};$scope.clear=function(){$scope.model.value.id=null;$scope.model.value.name=""}});angular.module("umbraco").controller("seoChecker.notfoundpageFieldController",function(){});angular.module("umbraco").controller("seoChecker.timeSelectorController",function($scope){$scope.bindData=function(){var h,m;for($scope.hours=[],h=0;h<24;h++)$scope.hours.push(h);for($scope.minutes=[],m=0;m<60;m++)$scope.minutes.push(m)};$scope.bindData()});angular.module("umbraco").controller("seoChecker.redirectsController",function($scope,$routeParams,$http,editorService,notificationsService,localizationService){var nodeId=$routeParams.id;$scope.bindData=function(){$http.get("backoffice/SEOChecker/SEOCheckerApi/GetRedirects?id="+nodeId).then(function(res){$scope.redirects=res.data});localizationService.localize("seoCheckerGeneral_deleteConfirm").then(function(value){$scope.confirmMessage=value});localizationService.localize("redirectDataType_notificationDeleteTitle").then(function(value){$scope.notificationDeleteTitle=value});localizationService.localize("redirectDataType_notificationDeleteDescription").then(function(value){$scope.notificationDeleteDescription=value});localizationService.localize("redirectDataType_notificationSaveTitle").then(function(value){$scope.notificationSaveTitle=value});localizationService.localize("redirectDataType_notificationSaveDescription").then(function(value){$scope.notificationSaveDescription=value})};$scope.deleteRedirect=function(redirectId){confirm($scope.confirmMessage)==!0&&$http.get("backoffice/SEOChecker/SEOCheckerApi/DeleteRedirect?id="+redirectId).then(function(){$scope.bindData();notificationsService.success($scope.notificationDeleteTitle,$scope.notificationDeleteDescription)})};$scope.setEditMode=function(redirectId){$scope.validationResult=null;$http.get("backoffice/SEOChecker/SEOCheckerApi/GetEmptyModel?id="+nodeId).then(function(res){$scope.model.value=res.data;for(var i=0;i<$scope.redirects.length;i++)$scope.redirects[i].notFoundId==redirectId&&($scope.model.value=$scope.redirects[i]);$scope.nodePicked={id:$scope.model.value.documentID,name:$scope.model.value.documentName}});$scope.editMode=!0};$scope.cancelEditMode=function(){$scope.editMode=!1};$scope.submitRedirect=function(){$scope.model.value.documentID=$scope.getPickedNodeId();$http.post("backoffice/SEOChecker/SEOCheckerApi/SaveRedirect",$scope.model.value).then(function(res){$scope.validationResult=res.data;res.data.valid==!0&&($scope.bindData(),$scope.editMode=!1,notificationsService.success($scope.notificationSaveTitle,$scope.notificationSaveDescription))})};$scope.pickContentNode=function(){function itemPicked(pickedItem){$scope.nodePicked=pickedItem}editorService.contentPicker({callback:itemPicked})};$scope.getPickedNodeId=function(){return $scope.nodePicked==null?0:$scope.nodePicked.id};$scope.deletePickedNode=function(){$scope.nodePicked=null};$scope.bindData()});angular.module("umbraco.resources").factory("seocheckerBackofficeResources",function($http){return{getLicenseInfo:function(){return $http.get("backoffice/seochecker/seocheckerlicenseinfoapi/licenseinfo")},initializeValidationForm:function(id){return $http.get("backoffice/seochecker/seocheckervalidateapi/initialize",{params:{id:id}})},validate:function(validateOptions){return $http.post("backoffice/seochecker/seocheckervalidateapi/validate",validateOptions)},saveValidation:function(validateOptions){return $http.post("backoffice/seochecker/seocheckervalidateapi/saveValidation",validateOptions)},initializeValidationqueue:function(){return $http.post("backoffice/seochecker/seocheckervalidationqueueapi/initializemodel")},validationqueue:function(model){return $http.post("backoffice/seochecker/seocheckervalidationqueueapi/initialize",model)},clearValidationqueue:function(model){return $http.post("backoffice/seochecker/seocheckervalidationqueueapi/clearvalidationqueue",model)},initializevalidationIssues:function(){return $http.post("backoffice/seochecker/validationissuesapi/initializemodel")},validationIssues:function(model){return $http.post("backoffice/seochecker/validationissuesapi/initialize",model)},initializeIgnoredValidationIssues:function(){return $http.post("backoffice/seochecker/ignoredvalidationissuesapi/initializemodel")},ignoredValidationIssues:function(model){return $http.post("backoffice/seochecker/ignoredvalidationissuesapi/initialize",model)},removeIgnoredValidationIssues:function(model){return $http.post("backoffice/seochecker/ignoredvalidationissuesapi/removefromignorelist",model)},initializeignoredConfigurationIssues:function(){return $http.post("backoffice/seochecker/ignoredconfigurationissuesapi/initializemodel")},ignoredConfigurationIssues:function(model){return $http.post("backoffice/seochecker/ignoredconfigurationissuesapi/initialize",model)},removeIgnoredConfigurationIssues:function(model){return $http.post("backoffice/seochecker/ignoredconfigurationissuesapi/removefromignorelist",model)},initializeRedirects:function(){return $http.post("backoffice/seochecker/redirectmanagementapi/initializemodel")},loadAllRedirects:function(model){return $http.post("backoffice/seochecker/redirectmanagementapi/initialize",model)},initializeInBoundLinkErrors:function(){return $http.post("backoffice/seochecker/inboundlinkerrorsapi/initializemodel")},loadAllInBoundLinkErrors:function(model){return $http.post("backoffice/seochecker/inboundlinkerrorsapi/initialize",model)},saveInBoundLinkErrors:function(model){return $http.post("backoffice/seochecker/inboundlinkerrorsapi/saveinboundlinkerrors",model)},initializeIgnoredInBoundLinkErrors:function(){return $http.post("backoffice/seochecker/ignoredinboundlinkerrorsapi/initializemodel")},loadAllIgnoredInBoundLinkErrors:function(model){return $http.post("backoffice/seochecker/ignoredinboundlinkerrorsapi/initialize",model)},removeIgnoredInboundLinkIssues:function(model){return $http.post("backoffice/seochecker/redirectmanagementapi/removefromignorelist",model)},getContentTypeOfRedirectUrl:function(oldUrl){return $http.get("backoffice/seochecker/redirectmanagementapi/getContentTypeOfRedirectUrl",{params:{redirectUrl:oldUrl}})},initializeConfigurationIssues:function(){return $http.post("backoffice/seochecker/configurationissuesapi/initializemodel")},configurationIssues:function(model){return $http.post("backoffice/seochecker/configurationissuesapi/initialize",model)},initializeNotifications:function(){return $http.get("backoffice/seochecker/seocheckernotificationsapi/initialize")},saveNotifications:function(notificationsConfig){return $http.post("backoffice/seochecker/seocheckernotificationsapi/save",notificationsConfig)},initializeEmailSettings:function(emailTemplate){return $http.get("backoffice/seochecker/emailsettingsapi/initialize",{params:{emailConfig:emailTemplate}})},saveEmailSettings:function(emailConfig){return $http.post("backoffice/seochecker/emailsettingsapi/save",emailConfig)},initializeDomainSettings:function(nodeId){return $http.get("backoffice/seochecker/domainsettingsapi/initialize",{params:{rootNodeId:nodeId}})},saveDomainSettings:function(domainConfig){return $http.post("backoffice/seochecker/domainsettingsapi/save",domainConfig)},initializeDefinitionSettings:function(alias){return $http.get("backoffice/seochecker/definitionsettingsapi/initialize",{params:{alias:alias}})},saveDefinitionSettings:function(domainConfig){return $http.post("backoffice/seochecker/definitionsettingsapi/save",domainConfig)},initializeGeneralSettingsModel:function(){return $http.post("backoffice/seochecker/generalsettingsapi/initializeemptymodel")},initializeGeneralSettings:function(config){return $http.post("backoffice/seochecker/generalsettingsapi/initialize",config)},saveGeneralSettings:function(config){return $http.post("backoffice/seochecker/generalsettingsapi/save",config)},initializePermissionSettings:function(){return $http.get("backoffice/seochecker/permissionsettingsapi/initialize")},savePermissionSettings:function(config){return $http.post("backoffice/seochecker/permissionsettingsapi/save",config)},initializePropertySelectorField:function(alias){return $http.get("backoffice/seochecker/propertyselectorfieldapi/initialize",{params:{alias:alias}})},initializePropertySelectorValue:function(propertyConfig){return $http.post("backoffice/seochecker/propertyselectorfieldapi/InitializeValue",propertyConfig)},selectPropertySelectorFields:function(propertyConfig){return $http.post("backoffice/seochecker/propertyselectorfieldapi/selectitems",propertyConfig)},deSelectPropertySelectorFields:function(propertyConfig){return $http.post("backoffice/seochecker/propertyselectorfieldapi/deselectitems",propertyConfig)},moveUpPropertySelectorFields:function(propertyConfig){return $http.post("backoffice/seochecker/propertyselectorfieldapi/moveup",propertyConfig)},moveDownPropertySelectorFields:function(propertyConfig){return $http.post("backoffice/seochecker/propertyselectorfieldapi/movedown",propertyConfig)},initializeDeleteRedirects:function(selectedItems){return $http.post("backoffice/seochecker/deleteredirectsdialogapi/initialize",selectedItems)},initializeEditRedirect:function(id){return $http.get("backoffice/seochecker/editredirectsdialogapi/initialize",{params:{id:id}})},saveRedirect:function(model){return $http.post("backoffice/seochecker/editredirectsdialogapi/save",model)},initializeExportRedirects:function(){return $http.get("backoffice/seochecker/exportredirectsdialogapi/initialize")},initializeImportRedirects:function(){return $http.post("backoffice/seochecker/importredirectsdialogapi/initializemodel")},bindImportRedirects:function(model){return $http.post("backoffice/seochecker/importredirectsdialogapi/initialize",model)},redirectUpdateModel:function(model){return $http.post("backoffice/seochecker/importredirectsdialogapi/update",model)},uploadFiles:function(formData){return $http.post("backoffice/seochecker/fileuploadapi/upload",formData,{transformRequest:angular.identity,headers:{"Content-Type":undefined}})},importRedirects:function(model){return $http.post("backoffice/seochecker/importredirectsdialogapi/import",model)},getExportRedirectErrorsUrl:function(model){return"backoffice/seochecker/importredirectsdialogapi/exporterrors?id="+model.exportErrorId},exportRedirects:function(model){return $http.post("backoffice/seochecker/exportredirectsdialogapi/export",model)},getRedirectExportUrl:function(model){return"backoffice/seochecker/exportredirectsdialogapi/doexport?contentTypeExportOptions="+model.contentTypesToExport.selectedItem+"&dataExportOptions="+model.dataToExport.selectedItem},bulkDeleteRedirects:function(model){return $http.post("backoffice/seochecker/deleteredirectsdialogapi/delete",model)},initializeDeleteValidationIssues:function(selectedItems){return $http.post("backoffice/seochecker/deletevalidationissuesdialogapi/initialize",selectedItems)},bulkDeleteValidationIssues:function(model){return $http.post("backoffice/seochecker/deletevalidationissuesdialogapi/delete",model)},initializeRevalidateIssues:function(model){return $http.post("backoffice/seochecker/revalidateissuesdialogapi/initialize",model)},refreshRevalidateIssues:function(model){return $http.post("backoffice/seochecker/revalidateissuesdialogapi/refresh",model,{timeout:100})},initializeDeleteConfigurationIssues:function(selectedItems){return $http.post("backoffice/seochecker/deleteconfigurationissuesdialogapi/initialize",selectedItems)},bulkDeleteConfigurationIssues:function(model){return $http.post("backoffice/seochecker/deleteconfigurationissuesdialogapi/delete",model)},clearValidationIssues:function(){return $http.post("backoffice/seochecker/validationissuesapi/clearallissues")},clearInboundLinkIssues:function(){return $http.post("backoffice/seochecker/redirectmanagementapi/clearallissues")},clearConfigurationIssues:function(){return $http.post("backoffice/seochecker/configurationissuesapi/clearallissues")},getAllProperties:function(){return $http.get("backoffice/seochecker/prevalueapi/getallproperties")},getAllImageProperties:function(){return $http.get("backoffice/seochecker/prevalueapi/getallimageproperties")},initializeDashboard:function(){return $http.get("backoffice/seochecker/seocheckerdashboardapi/initialize")},processLicenseFile:function(fileInfo){return $http.post("backoffice/seochecker/seocheckerdashboardapi/processlicense",fileInfo)},deleteTreeNodeById:function(id){return $http.get("backoffice/seochecker/treeapi/deleteTreeNode",{params:{id:id}})}}});angular.module("umbraco").controller("seoChecker.seoCheckerPropertyEditorController",function($scope,$routeParams,editorState,$http,seocheckerHelper){var culture=seocheckerHelper.isNullOrUndefined($routeParams.cculture)?$routeParams.mculture:$routeParams.cculture;$scope.titleLengthVisible=function(){return $scope.editMode&&$scope.model.value.seoTitle.length>0};$scope.descriptionLengthVisible=function(){return $scope.editMode&&$scope.model.value.seoDescription.length>0};$scope.initializeEditor=function(){$scope.blueprintMode=$scope.model.value.isBluePrint===!0;$scope.editMode=$scope.model.value.isBluePrint===!1&&$routeParams.section==="content";$scope.watchChanges()};$scope.validateTitleLength=function(){if($scope.editMode){var limit=$scope.model.value.config.maxTitleLength;$scope.seoTitleLength=$scope.parseTemplate($scope.model.value.seoTitle).length;$scope.seoTitleLengthClass=$scope.seoTitleLength>limit?"error":"valid"}};$scope.validateDescriptionLength=function(){if($scope.editMode){var maxLimit=$scope.model.value.config.maxDescriptionLength,minLimit=$scope.model.value.config.minDescriptionLength;$scope.seoDescriptionLength=$scope.model.value.seoDescription.length;$scope.seoDescriptionLengthClass=$scope.model.value.seoDescription.length<minLimit||$scope.model.value.seoDescription.length>maxLimit?"error":"valid"}};$scope.parseTemplate=function(titleValue){return(titleValue=seocheckerHelper.encodeHtmlBrackets(titleValue),$scope.editMode&&$scope.model.value.snippetTitleTemplate.indexOf("@@seotitle@@")!=-1)?$scope.model.value.snippetTitleTemplate.replace("@@seotitle@@",titleValue):titleValue};$scope.formatTitle=function(){if($scope.editMode){var title=$scope.model.value.seoTitle;return title==""&&(title=$scope.model.value.defaultTitlePropertyValue),title=$scope.parseTemplate(title),title=$scope.getFirst(title,"",$scope.model.config.maxTitleLength),$scope.parseKeyword($scope.model.value.focusKeyword,title)}return""};$scope.formatSnippetUrl=function(){if($scope.editMode){var url=$scope.model.value.snippetUrl.replace("http://","");return $scope.parseKeyword($scope.model.value.focusKeyword,url)}return""};$scope.formatDescription=function(){if($scope.editMode){var description=$scope.model.value.seoDescription;return description=seocheckerHelper.encodeHtmlBrackets(description),description==""&&(description=$scope.model.value.defaultDescriptionValue),description=$scope.getFirst(description,"...",$scope.model.config.maxDescriptionLength),$scope.parseKeyword($scope.model.value.focusKeyword,description)}return""};$scope.parseKeyword=function(focusKeyword,stringValue){var valueArray,i,focusArr,y;if($scope.editMode){if(!(focusKeyword==null||stringValue==null)){for(valueArray=$scope.parseText(stringValue),i=0;i<valueArray.length;i++)for(focusArr=focusKeyword.split(" "),y=0;y<focusArr.length;y++)focusArr[y].length>0&&focusArr[y].toLowerCase()==valueArray[i].toLowerCase()&&(valueArray[i]="<strong>"+valueArray[i]+"<\/strong>");stringValue=valueArray.join("")}return stringValue}return""};$scope.parseText=function(val){for(var arr=[],tmp=[],chars=[" ",'"',",",".",":",";"],i=0;i<val.length;i++)chars.indexOf(val[i])>=0?(arr.push(tmp.join("")),arr.push(val[i]),tmp=[]):tmp.push(val[i]);return arr.push(tmp.join("")),arr};$scope.openKeywordSelectionTool=function(){return window.open($scope.model.value.config.keywordSelectionTool,"_blank","width=900,height=700"),!1};$scope.getFirst=function(txt,suffixWhenLonger,limit){return txt.length>limit&&(txt=txt.substring(0,limit)+suffixWhenLonger),txt};$scope.doValidatePage=function(){var validationModel={nodeId:editorState.getCurrent().id,culture:culture,focusKeyword:$scope.model.value.focusKeyword};$scope.showValidationResult=!0;$scope.validationResult=null;$scope.validatingPage=!0;$http.post("backoffice/SEOChecker/SEOCheckerApi/Validate",validationModel).then(function(res){$scope.validationResult=res.data;$scope.validatingPage=!1})};$scope.watchChanges=function(){$scope.editMode&&($scope.$watch("model.value.requestId",function(){$scope.shouldResetModel()?$scope.resetModel():($scope.model.value.config.validationMode==="always"||$scope.postback&&$scope.model.value.config.validationMode==="onsave")&&$scope.doValidatePage();$scope.postback=!0}),$scope.validateTitleLength(),$scope.validateDescriptionLength())};$scope.shouldResetModel=function(){return $scope.model.value.documentId===0&&editorState.getCurrent().id>0};$scope.resetModel=function(){$scope.model.value.documentId=editorState.getCurrent().id;$http.post("backoffice/SEOChecker/SEOCheckerApi/resetModel",$scope.model.value).then(function(res){$scope.model.value=res.data;$scope.initializeEditor()})};seocheckerHelper.isNullOrUndefined($scope.model.value)?$scope.definitionMode=!0:$scope.shouldResetModel()?$scope.resetModel():$scope.initializeEditor()});angular.module("umbraco.services").factory("seocheckerHelper",function(notificationsService,navigationService,seocheckerBackofficeResources,$timeout){var service={showNotification:function(notificationStatus){notificationStatus.isError===!1?notificationsService.success(notificationStatus.header,notificationStatus.description):notificationsService.error(notificationStatus.header,notificationStatus.description)},showServerError:function(){notificationsService.error("Server error","A server error occured")},applyValidationErrors:function(source,target){target.isInValid=source.isInValid;target.validationMessages=source.validationMessages},syncPath:function(path){navigationService.syncTree({tree:"seochecker",path:path})},isSortDirection:function(columnName,sortDirection,currentSortColumn,currentSortDirection){return columnName===currentSortColumn&&sortDirection===currentSortDirection},handleSelectAll:function(selected,items){angular.forEach(items,function(item){item.selected=selected})},getSelectedItems:function(items){var result=[];return angular.forEach(items,function(item){item.selected===!0&&result.push(item)}),result},anyItemSelected:function(items){var result=!1;return angular.forEach(items,function(item){if(item.selected===!0){result=!0;return}}),result===!0},downloadFile:function(url){var redirectExport=document.createElement("a");redirectExport.id="downloadframe";redirectExport.style.display="none";document.body.appendChild(redirectExport);redirectExport.href=url;redirectExport.click();$timeout(function(){document.body.removeChild(redirectExport)},1e3)},fixJqueryResult:function(result){return result.replace(")]}',","")},uploadFiles:function(folder,file,cb){var formData=new FormData,request;formData.set("folderName",folder);formData.set("file",file,file.name);request=new XMLHttpRequest;request.onreadystatechange=function(){request.readyState===4&&cb(request.responseText)};request.open("POST","backoffice/seochecker/fileuploadapi/upload");request.send(formData)},getTabByName:function(tabs,name){for(var i=0;i<tabs.length;i++)if(tabs[i].alias===name)return tabs[i];return{active:!1,alias:"emptyTab",id:-1,label:"empty",properties:[]}},updateTab:function(oldModel,newModel,tabName){var newtab=service.getTabByName(newModel.tabs,tabName),oldTabs=service.getTabByName(oldModel.tabs,tabName);oldTabs.properties=newtab.properties},isNullOrUndefined:function(val){return val===null||angular.isUndefined(val)},encodeHtmlBrackets:function(val){return service.isNullOrUndefined(val)||(val=val.replace("<","&lt;"),val=val.replace(">","&gt;")),val}};return service});angular.module("umbraco").controller("seoChecker.seoCheckerSocialPropertyEditorController",function($scope,$routeParams,editorState,$http,seocheckerHelper){function buildimagePickerModel(alias,label,description){return{editor:"Umbraco.MediaPicker",label:label,description:description,hideLabel:!1,view:"mediapicker",alias:alias,value:$scope.getSocialImageValue(),validation:{mandatory:!1,pattern:""},config:{multiPicker:!1}}}seocheckerHelper.isNullOrUndefined($scope.model.value)?$scope.definitionMode=!0:$scope.blueprintMode=$scope.model.value.isBluePrint===!0;$scope.socialImageOrientation="Landscape";$scope.setClass=function(options){var selectedcss=options.cssClass;return options.selected&&(selectedcss=selectedcss+"-active"),"social socialbutton "+selectedcss};$scope.activePreviewType=function(){return!0};$scope.setFirstItemActive=function(){if($scope.editMode){var all=$scope.model.value.config.socialNetworkOptionsConfig;all.length>0&&$scope.setActive(all[0],all)}};$scope.setActive=function(options,all){for(i=0;i<all.length;i++)all[i].selected=!1;options.selected=!0;$scope.model.activeNetwork=options};$scope.parseOgTemplate=function(titleValue){return(titleValue=seocheckerHelper.encodeHtmlBrackets(titleValue),$scope.editMode&&$scope.model.value.ogSnippetTitleTemplate.indexOf("@@seotitle@@")!=-1)?$scope.model.value.ogSnippetTitleTemplate.replace("@@seotitle@@",titleValue):titleValue};$scope.parseTwitterTemplate=function(titleValue){return(titleValue=seocheckerHelper.encodeHtmlBrackets(titleValue),$scope.editMode&&$scope.model.value.twitterSnippetTitleTemplate.indexOf("@@seotitle@@")!=-1)?$scope.model.value.twitterSnippetTitleTemplate.replace("@@seotitle@@",titleValue):titleValue};$scope.renderSocialImage=function(){$scope.editMode&&(seocheckerHelper.isNullOrUndefined($scope.model.value.socialImage)?seocheckerHelper.isNullOrUndefined($scope.model.value.defaultImageValue)?$scope.socialImageUrl=null:($scope.socialImageUrl=$scope.model.value.defaultImageValue.mediaUrl,$scope.socialImageOrientation=$scope.model.value.defaultImageValue.imageOrientation):($scope.socialImageUrl=$scope.model.value.socialImage.mediaUrl,$scope.socialImageOrientation=$scope.model.value.socialImage.imageOrientation),seocheckerHelper.isNullOrUndefined($scope.socialImageUrl)?($scope.socialFacebookImage=null,$scope.socialTwitterImage=null,$scope.socialTwitterLargeImage=null,$scope.socialImageOrientation=null):($scope.socialFacebookImage=$scope.socialImageOrientation==="Landscape"?$scope.socialImageUrl+"?width=600&height=314&mode=crop":$scope.socialImageUrl+"?width=171&height=259&mode=crop",$scope.socialTwitterImage=$scope.socialImageUrl+"?width=135&height=135&mode=crop",$scope.socialTwitterLargeImage=$scope.socialImageUrl+"?width=600&height=314&mode=crop"))};$scope.formatOgTitle=function(){if($scope.editMode){var title=$scope.model.value.ogTitle;return title==""&&(title=$scope.model.value.defaultTitlePropertyValue),title=$scope.parseOgTemplate(title),$scope.getFirst(title,"",60)}return""};$scope.formatTwitterTitle=function(){if($scope.editMode){var title=$scope.model.value.twitterTitle;return title==""&&(title=$scope.model.value.defaultTitlePropertyValue),title=$scope.parseTwitterTemplate(title),$scope.getFirst(title,"",60)}return""};$scope.formatOgDescription=function(){if($scope.editMode){var description=$scope.model.value.ogDescription;return description==""&&(description=$scope.model.value.defaultDescriptionValue),description=$scope.getFirst(description,"...",$scope.model.config.maxDescriptionLength),seocheckerHelper.encodeHtmlBrackets(description)}return""};$scope.formatTwitterDescription=function(){if($scope.editMode){var description=$scope.model.value.twitterDescription;return description==""&&(description=$scope.model.value.defaultDescriptionValue),description=$scope.getFirst(description,"...",$scope.model.config.maxDescriptionLength),seocheckerHelper.encodeHtmlBrackets(description)}return""};$scope.getFirst=function(txt,suffixWhenLonger,limit){return txt.length>limit&&(txt=txt.substring(0,limit)+suffixWhenLonger),txt};$scope.watchSocialImageChange=function(){$scope.editMode&&$scope.$watch("imagePicker.model.value",function(){seocheckerHelper.isNullOrUndefined($scope.imagePicker.model.value)||$scope.imagePicker.model.value==""?($scope.imagePicker.selectedItem=null,$scope.model.value.socialImage=null,$scope.renderSocialImage()):$http.get("backoffice/SEOChecker/SEOCheckerApi/GetSocialImage?mediaId="+$scope.imagePicker.model.value).then(function(res){$scope.model.value.socialImage=res.data;$scope.renderSocialImage()})})};$scope.imagePicker={model:{editor:"Umbraco.MediaPicker",label:"Image",description:"",hideLabel:!1,view:"mediapicker",alias:"socialImage",validation:{mandatory:!1,pattern:""},config:{multiPicker:!1}},existingValue:null,hasValue:!1};$scope.getSocialImageValue=function(){return!seocheckerHelper.isNullOrUndefined($scope.model.value)&&!seocheckerHelper.isNullOrUndefined($scope.model.value.socialImage)?$scope.model.value.socialImage.udi:null};$scope.initializeEditor=function(){$scope.editMode=$scope.model.value.isBluePrint===!1&&$routeParams.section==="content";$scope.imagePicker.model=buildimagePickerModel("socialImage","Image","Social image picker");$scope.setFirstItemActive();$scope.watchSocialImageChange();$scope.renderSocialImage();$scope.watchChanges()};$scope.watchChanges=function(){$scope.editMode&&$scope.$watch("model.value.requestId",function(){$scope.shouldResetModel()&&$scope.resetModel();$scope.postback=!0})};$scope.shouldResetModel=function(){return $scope.model.value.documentId===0&&editorState.getCurrent().id>0};$scope.resetModel=function(){$scope.model.value.documentId=editorState.getCurrent().id;$http.post("backoffice/SEOChecker/SEOCheckerApi/resetSocialModel",$scope.model.value).then(function(res){$scope.model.value=res.data;$scope.initializeEditor()})};seocheckerHelper.isNullOrUndefined($scope.model.value)?$scope.definitionMode=!0:$scope.shouldResetModel()?$scope.resetModel():$scope.initializeEditor()})